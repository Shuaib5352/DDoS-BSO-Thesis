# نظام كشف هجمات DDoS باستخدام إطار التعلم الآلي الهجين المحسّن بخوارزمية تحسين سرب الخفافيش (BSO-Hybrid)
## Improved Detection of DDoS Attacks Using a Hybrid Machine Learning Framework Optimized with Bat Swarm Optimization (BSO)

**تم تصميم وتطوير البرنامج بواسطة: SHUAIB AYAD JASIM**

---

## الفصل الأول: المقدمة

### 1.1 خلفية البحث

تُعد هجمات حجب الخدمة الموزعة (Distributed Denial of Service - DDoS) من أخطر التهديدات السيبرانية التي تواجه البنية التحتية للشبكات في العصر الرقمي. تهدف هذه الهجمات إلى إغراق الخوادم والشبكات بكميات هائلة من حركة المرور الضارة، مما يؤدي إلى تعطيل الخدمات المشروعة ومنع المستخدمين الحقيقيين من الوصول إلى الموارد.

### 1.2 أهمية البحث

- **التزايد المستمر في الهجمات**: ارتفاع عدد هجمات DDoS بنسبة 150% خلال السنوات الأخيرة
- **التطور في أساليب الهجوم**: ظهور أنواع جديدة ومعقدة من الهجمات في بيئات IoT
- **الحاجة للكشف الآني**: ضرورة اكتشاف الهجمات في الوقت الفعلي لتقليل الأضرار
- **تحسين دقة الكشف**: استخدام التحسين الميتاهيورستي لاختيار الميزات وضبط المعاملات

### 1.3 أهداف البحث

1. تطوير نظام هجين (BSO-Hybrid) يجمع بين اختيار الميزات وتحسين معاملات Random Forest
2. تقليل أبعاد الميزات مع الحفاظ على دقة عالية في الكشف
3. مقارنة أداء BSO-Hybrid مع 11 خوارزمية تعلم آلي أخرى
4. بناء واجهة مستخدم تفاعلية للمراقبة في الوقت الفعلي

---

## الفصل الثاني: الإطار النظري

### 2.1 هجمات DDoS

#### 2.1.1 تعريف هجمات DDoS

هجمات حجب الخدمة الموزعة هي محاولات خبيثة لتعطيل حركة المرور الطبيعية لخادم أو خدمة أو شبكة مستهدفة من خلال إغراق الهدف أو البنية التحتية المحيطة به بفيض من حركة المرور على الإنترنت.

#### 2.1.2 أنواع الهجمات المدروسة (CICIoT2023)

| نوع الهجوم | الوصف | عدد العينات |
|------------|-------|-------------|
| DDoS-SYN_Flood | استغلال مصافحة TCP ثلاثية الاتجاه | 25,000 |
| DDoS-ACK_Fragmentation | تجزئة حزم ACK لتجاوز أنظمة الكشف | 25,000 |
| Backdoor_Malware | برامج خبيثة للتحكم عن بعد | 3,466 |
| Recon-PortScan | مسح المنافذ للاستطلاع | 25,000 |
| BenignTraffic (عادي) | حركة مرور شبكية طبيعية | 40,000 |

### 2.2 خوارزمية تحسين سرب الخفافيش (BSO)

#### 2.2.1 مبدأ عمل الخوارزمية

خوارزمية تحسين سرب الخفافيش (Bat Swarm Optimization) هي خوارزمية تحسين ميتاهيورستية مستوحاة من سلوك الخفافيش في استخدام السونار للتنقل والصيد. تم تطويرها بواسطة Xin-She Yang في عام 2010.

#### 2.2.2 المعادلات الرياضية

**تحديث التردد:**

$$f_i = f_{min} + (f_{max} - f_{min}) \times \beta$$

**تحديث السرعة:**

$$v_i^{t+1} = v_i^t + (x_i^t - x_{best}) \times f_i$$

**تحديث الموقع:**

$$x_i^{t+1} = x_i^t + v_i^{t+1}$$

**البحث المحلي:**

$$x_{new} = x_{old} + \epsilon \times A^t$$

**تحديث معدل النبض:**

$$r_i^{t+1} = r_i^0 \times [1 - e^{-\gamma t}]$$

**تحديث الصوت:**

$$A_i^{t+1} = \alpha \times A_i^t$$

#### 2.2.3 معاملات الخوارزمية (BSO-Hybrid)

| المعامل | القيمة | الوصف |
|---------|--------|-------|
| حجم السرب | 25 | عدد الخفافيش في السرب |
| التردد الأدنى (fmin) | 0.0 | الحد الأدنى للتردد |
| التردد الأقصى (fmax) | 2.0 | الحد الأقصى للتردد |
| معدل الصوت الأولي (A0) | 0.95 | شدة الصوت الابتدائية |
| معدل النبض الأولي (r0) | 0.5 | معدل إرسال النبضات |
| عدد التكرارات | 50 | الحد الأقصى للتكرارات |
| البعد | 39 + 4 | 39 ميزة ثنائية + 4 معاملات RF |

### 2.3 الابتكار: BSO-Hybrid (التحسين المشترك)

على عكس الطرق التقليدية التي تقتصر على اختيار الميزات فقط (مثل PSO-RF، GA-RF، GWO-RF)، يقوم BSO-Hybrid بالتحسين المشترك لـ:

1. **اختيار الميزات**: متجه ثنائي بطول 39 (ميزة مختارة أم لا)
2. **معاملات Random Forest**: n_estimators، max_depth، min_samples_split، max_features

**دالة اللياقة:**

$$F(S, \theta) = \alpha \times \text{CV-Accuracy}(S, \theta) + \beta \times \left(1 - \frac{|S|}{|F|}\right)$$

حيث:
- **α** = 0.9 (وزن الدقة)
- **β** = 0.1 (وزن تقليل الميزات)
- **S** = مجموعة الميزات المختارة
- **θ** = معاملات RF المحسّنة
- **|F|** = إجمالي عدد الميزات (39 ميزة)

---

## الفصل الثالث: مجموعة البيانات

### 3.1 مجموعة بيانات CICIoT2023

تم استخدام مجموعة بيانات **CICIoT2023** الصادرة عن معهد الأمن السيبراني الكندي (Canadian Institute for Cybersecurity)، والتي تمثل هجمات حقيقية على أجهزة IoT.

### 3.2 خصائص مجموعة البيانات

| الخاصية | القيمة |
|---------|--------|
| إجمالي العينات | 118,466 |
| عينات التدريب (70%) | 82,926 |
| عينات التحقق (10%) | 11,847 |
| عينات الاختبار (20%) | 23,693 |
| عدد الميزات الأصلية | 39 |
| عدد الميزات بعد BSO-Hybrid | 19 (تقليل 51.3%) |
| عدد الفئات | 5 |
| معالجة عدم التوازن | SMOTE |

### 3.3 الميزات الـ 19 المختارة بواسطة BSO-Hybrid (مرتبة حسب الأهمية)

| الترتيب | اسم الميزة | الأهمية |
|---------|-----------|---------|
| 1 | ack_count | 0.22448 |
| 2 | Header_Length | 0.17892 |
| 3 | ack_flag_number | 0.11256 |
| 4 | HTTP | 0.06734 |
| 5 | Duration | 0.05891 |
| 6 | Tot size | 0.05123 |
| 7 | Number | 0.04567 |
| 8 | rst_count | 0.03891 |
| 9 | Magnitue | 0.03234 |
| 10 | AVG | 0.02678 |
| 11 | UDP | 0.02345 |
| 12 | fin_flag_number | 0.02012 |
| 13 | IAT | 0.01756 |
| 14 | syn_count | 0.01534 |
| 15 | Radius | 0.01345 |
| 16 | fin_count | 0.01123 |
| 17 | Variance | 0.00989 |
| 18 | Tot sum | 0.00834 |
| 19 | Min | 0.00712 |

---

## الفصل الرابع: منهجية البحث

### 4.1 بنية النظام

```
┌──────────────────────────────────────────────────────────────────┐
│              نظام كشف هجمات DDoS (BSO-Hybrid)                    │
├──────────────────────────────────────────────────────────────────┤
│  1. جمع البيانات → 2. المعالجة الأولية → 3. SMOTE             │
│         ↓                                                        │
│  4. BSO-Hybrid: اختيار ميزات + تحسين معاملات RF مشترك           │
│     ┌─────────────────────────────────────────────┐              │
│     │  متجه الخفاش = [39 بت ميزات | 4 معاملات RF] │              │
│     │  pop=25, iter=50, α=0.9, β=0.1              │              │
│     └─────────────────────────────────────────────┘              │
│         ↓                                                        │
│  5. النموذج الأمثل: RF(n=266, depth=20, split=7, feat=0.469)   │
│         ↓                                                        │
│  6. التقييم: 10-fold CV + test set (20,644 عينة)                │
│         ↓                                                        │
│  7. المقارنة: 12 نموذج + اختبارات إحصائية (Wilcoxon)            │
└──────────────────────────────────────────────────────────────────┘
```

### 4.2 معاملات RF المحسّنة بواسطة BSO-Hybrid

| المعامل | القيمة المحسّنة |
|---------|-----------------|
| n_estimators | 266 |
| max_depth | 20 |
| min_samples_split | 7 |
| max_features | 0.469 |

### 4.3 تقنية SMOTE لمعالجة عدم التوازن

تم استخدام SMOTE (Synthetic Minority Over-sampling Technique) لموازنة الفئات قبل التدريب، مع تطبيقه فقط على بيانات التدريب لتفادي تسريب البيانات.

---

## الفصل الخامس: النتائج والمناقشة

### 5.1 نتائج مقارنة النماذج (12 نموذج)

| النموذج | الدقة (%) | الضبط (%) | الاستدعاء (%) | F1-Weighted (%) | F1-Macro (%) | وقت التدريب |
|---------|----------|----------|-------------|----------------|-------------|-------------|
| **BSO-Hybrid RF (المقترح)** | **89.82** | **90.19** | **89.82** | **89.90** | **84.24** | **22.2 دقيقة** |
| XGBoost | 90.37 | 90.83 | 90.37 | 90.47 | 84.74 | 0.95 دقيقة |
| Random Forest | 89.74 | 90.14 | 89.74 | 89.86 | 83.06 | 0.28 دقيقة |
| GA-RF | 89.60 | 90.01 | 89.60 | 89.69 | 83.66 | 15.8 دقيقة |
| PSO-RF | 88.78 | 89.34 | 88.78 | 88.85 | 81.82 | 18.3 دقيقة |
| GWO-RF | 88.45 | 88.98 | 88.45 | 88.55 | 81.15 | 16.5 دقيقة |
| K-Nearest Neighbors | 87.53 | 88.12 | 87.53 | 87.71 | 80.34 | 0.05 دقيقة |
| Decision Tree | 86.20 | 87.02 | 86.20 | 86.33 | 80.62 | 0.02 دقيقة |
| SVM (Linear) | 82.02 | 83.67 | 82.02 | 81.38 | 72.83 | 3.41 دقيقة |
| Logistic Regression | 73.04 | 77.23 | 73.04 | 72.16 | 60.45 | 0.15 دقيقة |
| SGD Classifier | 72.09 | 76.45 | 72.09 | 71.23 | 59.12 | 0.08 دقيقة |
| Naive Bayes | 51.37 | 69.34 | 51.37 | 46.52 | 38.91 | 0.01 دقيقة |

### 5.2 ملاحظات مهمة على النتائج

> **BSO-Hybrid RF** لا يحقق أعلى دقة مطلقة (XGBoost أعلى بـ 0.55%)، لكنه يتميز بـ:
> 1. **تقليل الأبعاد بنسبة 51.3%** (من 39 إلى 19 ميزة)
> 2. **تحسين مشترك**: اختيار ميزات + ضبط معاملات RF في آن واحد
> 3. **تفوق إحصائي** على PSO-RF (+2.42% F1-macro, p=0.002) وGA-RF وGWO-RF
> 4. **كفاءة حسابية أعلى** في مرحلة التنبؤ بسبب عدد الميزات الأقل

### 5.3 نتائج كشف كل فئة (BSO-Hybrid RF)

| الفئة | الضبط (%) | الاستدعاء (%) | F1-Score (%) | العينات |
|-------|----------|-------------|-------------|---------|
| DDoS-ACK_Fragmentation | 100.00 | 100.00 | 100.00 | 5,000 |
| DDoS-SYN_Flood | 99.92 | 99.92 | 99.92 | 5,000 |
| BenignTraffic | 80.60 | 85.60 | 83.03 | 5,000 |
| Recon-PortScan | 85.38 | 76.90 | 80.91 | 5,000 |
| Backdoor_Malware | 51.16 | 65.37 | 57.44 | 644 |

### 5.4 مصفوفة الارتباك — BSO-Hybrid RF (20,644 عينة اختبار)

```
                    التنبؤ
              Back   Benign  ACK    SYN    Recon
الفعلي Back  │ 421  │  122  │   0  │   0  │  101 │
       Ben   │ 163  │ 4280  │   0  │   0  │  557 │
       ACK   │   0  │    0  │5000  │   0  │    0 │
       SYN   │   0  │    0  │   4  │4996  │    0 │
       Recon │ 239  │  916  │   0  │   0  │ 3845 │
```

**مصفوفة ثنائية (هجوم مقابل عادي):**
- True Positive: 14,262
- True Negative: 4,280
- False Positive: 720
- False Negative: 1,038
- نسبة الإنذارات الكاذبة (FPR): 14.40%

### 5.5 مقارنة المحسّنات الميتاهيورستية

| المحسّن | الميزات المختارة | الدقة (%) | F1-Macro (%) | الوقت (دقيقة) |
|---------|-----------------|----------|-------------|--------------|
| BSO-Hybrid | 19 | 89.82 | 84.24 | 22.2 |
| GA-RF | 21 | 89.60 | 83.66 | 15.8 |
| PSO-RF | 22 | 88.78 | 81.82 | 18.3 |
| GWO-RF | 20 | 88.45 | 81.15 | 16.5 |
| بدون تحسين (RF) | 39 | 89.74 | 83.06 | 0.28 |

### 5.6 التحليل الإحصائي (Wilcoxon Signed-Rank Test)

| المقارنة | p-value | الدلالة | فرق F1-Macro |
|----------|---------|---------|-------------|
| BSO-Hybrid vs Decision Tree | ≈0 | دال إحصائياً *** | +3.62% |
| BSO-Hybrid vs PSO-RF | 0.002 | دال إحصائياً ** | +2.42% |
| BSO-Hybrid vs GWO-RF | 0.005 | دال إحصائياً ** | +3.09% |
| BSO-Hybrid vs KNN | 0.008 | دال إحصائياً ** | +3.90% |
| BSO-Hybrid vs GA-RF | 0.045 | دال إحصائياً * | +0.58% |
| BSO-Hybrid vs RF | 0.156 | غير دال | +1.18% |
| BSO-Hybrid vs XGBoost | 0.312 | غير دال | -0.50% |

---

## الفصل السادس: مكونات البرنامج

### 6.1 الواجهة الرئيسية

| المكون | الوظيفة |
|--------|---------|
| لوحة التحكم الرئيسية | عرض المقاييس والإحصائيات في الوقت الفعلي |
| مراقبة الشبكة الحية | تتبع حركة المرور وتحليلها آنياً |
| تحليل BSO | عرض تقارب الخوارزمية وأداء التحسين |
| تصنيف ML | نتائج التصنيف والتنبؤات |
| مقارنة الخوارزميات | جداول ورسوم بيانية لـ 12 نموذج |
| تقييم الأداء | مقاييس ROC, PR, Confusion Matrix |
| لوحة البحث الأكاديمي | أدوات للباحثين والأكاديميين |
| نتائج النشر | تصدير للمقالات العلمية |

### 6.2 التقنيات المستخدمة

| التقنية | الإصدار | الاستخدام |
|---------|---------|----------|
| Next.js | 14 | إطار العمل الرئيسي |
| React | 18+ | بناء واجهة المستخدم |
| TypeScript | 5+ | لغة البرمجة |
| Tailwind CSS | 4+ | التنسيق والتصميم |
| Recharts | 2+ | الرسوم البيانية |
| Python | 3.13 | التجارب (sklearn, xgboost, imbalanced-learn) |
| shadcn/ui | — | مكونات واجهة المستخدم |

### 6.3 ملفات المشروع الرئيسية

```
ddos-detection-app/
├── app/page.tsx                    # الصفحة الرئيسية
├── components/
│   ├── system-overview.tsx         # نظرة عامة على النظام
│   ├── live-dashboard.tsx          # لوحة المراقبة الحية
│   ├── bso-visualization.tsx       # تصور خوارزمية BSO
│   ├── ml-classification-panel.tsx # لوحة التصنيف
│   ├── academic-research-panel.tsx # لوحة البحث الأكاديمي
│   ├── publication-results.tsx     # نتائج النشر
│   └── detailed-results-panel.tsx  # النتائج التفصيلية
├── lib/
│   ├── ciciot2023-dataset.ts          # بيانات التجربة الحقيقية
│   ├── bso-optimizer.ts            # خوارزمية BSO
│   ├── algorithm-comparator.ts     # مقارنة الخوارزميات
│   └── live-data-engine.ts         # محرك البيانات الحية
├── scripts/
│   └── real_experiment.py          # سكربت التجربة الحقيقية (v4)
├── public/
│   └── experiment_results.json     # نتائج التجربة
└── docs/                           # التوثيق
```

---

## الفصل السابع: الخلاصة والتوصيات

### 7.1 الخلاصة

1. **تطوير BSO-Hybrid**: نظام تحسين مشترك لاختيار الميزات وضبط معاملات RF، يحقق دقة 89.82% بـ 19 ميزة فقط
2. **تقليل الأبعاد بنسبة 51.3%**: من 39 إلى 19 ميزة مع الحفاظ على دقة مماثلة لـ RF الكامل
3. **تفوق إحصائي**: BSO-Hybrid يتفوق بشكل دال إحصائياً على PSO-RF (p=0.002) وGWO-RF (p=0.005)
4. **مقارنة شاملة**: 12 نموذج تعلم آلي مع اختبارات Wilcoxon

### 7.2 المساهمات العلمية

1. تطبيق BSO-Hybrid كمحسّن مشترك (اختيار ميزات + تحسين معاملات) وليس اختيار ميزات فحسب
2. مقارنة مع 4 محسّنات ميتاهيورستية (PSO, GA, GWO, BSO-Hybrid)
3. تقييم على CICIoT2023 بتصنيف متعدد الفئات (5 فئات) وليس ثنائي فقط
4. واجهة تفاعلية كاملة لعرض النتائج ومراقبة الشبكة

### 7.3 القيود والتوصيات المستقبلية

1. **أداء Backdoor_Malware ضعيف** (F1=57.44%): يحتاج لتقنيات أخرى مثل التعلم العميق
2. **XGBoost أعلى دقة** بـ 0.55%: لكن بدون تقليل ميزات
3. **التعلم العميق**: تطبيق CNN/LSTM لتحسين الكشف
4. **مجموعات بيانات إضافية**: اختبار على NSL-KDD وCICIDS2017

---

## المراجع

1. Neto, E. C. P., et al. (2023). CICIoT2023: A Real-Time Dataset and Benchmark for Large-Scale Attacks in IoT Environment. Sensors, 23(13).
2. Yang, X. S. (2010). A new metaheuristic bat-inspired algorithm. Nature inspired cooperative strategies for optimization (NICSO 2010), 65-74.
3. Breiman, L. (2001). Random forests. Machine learning, 45(1), 5-32.
4. Chawla, N. V., et al. (2002). SMOTE: Synthetic Minority Over-sampling Technique. JAIR, 16, 321-357.
5. Ferrag, M. A., et al. (2023). Edge-IIoTset: A New Comprehensive Realistic Cyber Security Dataset. IEEE Access.

---

**تم إعداد هذا التوثيق بواسطة: SHUAIB AYAD JASIM**
**تاريخ الإعداد: فبراير 2026**
